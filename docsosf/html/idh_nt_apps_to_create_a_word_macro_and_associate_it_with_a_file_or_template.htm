<HTML>
<HEAD>
 <TITLE>Creating a Word Macro and associating it with a file or template</TITLE>
 <meta name="copyright" value="©2001, Force Computers, Inc.">
 <META NAME="generator" CONTENT="RoboHELP by eHelp Corporation www.ehelp.com">
 <script language="javascript" title="WebHelpInlineScript">
<!--
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) >= 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
//-->
 </script>
 <style>
<!--
  div.WebHelpPopupMenu {position:absolute; left:0px; top:0px; z-index:4; visibility:hidden;}
  p.WebHelpNavBar {text-align:right;}
-->
 </style>
 <SCRIPT language="JavaScript">
<!--
 onerror = null; 
//-->
 </SCRIPT>
 <SCRIPT language="JavaScript" src="ehlpdht1.js" title="WebHelpEhlpDhtmExtJs" name="EHELP_DHTM">
 </SCRIPT>
 <SCRIPT language="JavaScript1.2" src="ehlpdht2.js" title="WebHelpEhlpDhtmExtJs" name="EHELP_DHTM">
 </SCRIPT>
</HEAD>
<BODY style="font-family:'Arial'; font-size:9pt;  background-color:white;" bgcolor="white">
 <SCRIPT language="JavaScript" title="WebHelpNavBar">
<!--
gbstrRelHomePageURL="";
if (parseInt(navigator.appVersion) >=3  && window.name.indexOf("BSSCPopup") == -1)
{
var strNvHome=""; var strNvBrowse=""; var strNvWebSearch="";
strNvBrowse="<a href='idh_nt_apps_running_dectalk_software_from_other_applications.htm'><img src='bsscnav4.gif' width=27 height=19 border=no></a><a href='idh_nt_apps_to_associate_a_macro_with_a_tool_bar_button.htm'><img src='bsscnav5.gif' width=27 height=19 border=no></a>"
if ((strNvHome.length != 0) || (strNvBrowse.length != 0) || (strNvWebSearch.length != 0)) {
  document.write("<p id='NavBar' align='right' class=WebHelpNavBar><nobr><font size=1>");
  if (strNvHome.length != 0) document.write(strNvHome);
  if (strNvBrowse.length != 0) document.write(strNvBrowse);
  if (strNvWebSearch.length != 0) document.write(strNvWebSearch);
  document.write("</font>&nbsp;&nbsp;&nbsp;</nobr></p>");
  }
}
//-->
 </SCRIPT>
 <H1 align="left"  style="font-size:12pt;margin-right:6.50pt;margin-top:4.00pt;margin-bottom:6.00pt;text-align:left;" ><B><FONT size=2  style="font-family:'Arial'; font-size:10pt; font-weight:bold; " >Creating a Word Macro and associating it with a file or template</FONT></B></H1>
 <P align="left"  style="margin-top:0.00pt;margin-bottom:8.00pt;text-align:left;" ><A href="idh_nt_apps_creating_a_word_macro.htm"><IMG SRC="btn_mini.gif" border=0 height=14 width=14 alt="btn_mini.gif"></A><FONT size=2  style="font-family:'Helvetica'; font-size:10pt; " >  Click </FONT><A href="idh_nt_apps_creating_a_word_macro.htm"><FONT size=2  style="font-family:'Helvetica'; font-size:10pt; " >here</FONT></A><FONT size=2  style="font-family:'Helvetica'; font-size:10pt; " > to see a numbered graphic illustrating the following procedure.</FONT></P>
 <P align="left"  style="margin-top:0.00pt;margin-bottom:8.00pt;text-align:left;" ><FONT size=2  style="font-family:'Helvetica'; font-size:10pt; " >The first step in running DECtalk Software from a Microsoft Word document is creating the Word macro that links Word and DECtalk through the Dynamic Data Exchange (DDE) server. You only have to create this macro once and associate it with a button, hot key, or menu command. If you make the macro part of a permanent .dot (template) file, DECtalk Software will always be available when you edit a document associated with that template.</FONT></P>
 <P align="left"  style="margin-top:0.00pt;margin-bottom:8.00pt;text-align:left;" ><FONT size=2  style="font-family:'Helvetica'; font-size:10pt; " >To create a Word macro:</FONT></P>
 <TABLE width="531" cellspacing='0' cellpadding="1">
  <TR valign=top>
  <TD width="18.06%">
  <P align="center"  style="margin-top:2.05pt;margin-bottom:3.95pt;text-align:center;" ><B><FONT size=1 color=black  style="font-family:'Helvetica'; font-size:9pt; color:black; font-weight:bold; letter-spacing:-0.25pt;" >Task/Location</FONT></B></P></TD>
  <TD width="10.84%">
  <P align="center"  style="margin-top:2.05pt;margin-bottom:3.95pt;text-align:center;" >&nbsp;</P></TD>
  <TD width="33.86%">
  <P align="center"  style="margin-top:2.05pt;margin-bottom:3.95pt;text-align:center;" ><B><FONT size=1 color=black  style="font-family:'Helvetica'; font-size:9pt; color:black; font-weight:bold; letter-spacing:-0.25pt;" >Action</FONT></B></P></TD>
  <TD width="37.25%">
  <P align="center"  style="margin-top:2.05pt;margin-bottom:3.95pt;text-align:center;" ><B><FONT size=1 color=black  style="font-family:'Helvetica'; font-size:9pt; color:black; font-weight:bold; letter-spacing:-0.25pt;" >Result</FONT></B></P></TD></TR>
  <TR valign=top>
  <TD width="18.06%" bgcolor="#e5e5e5">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >Word dialog</FONT></P></TD>
  <TD width="10.84%">
  <P align="left"  style="margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><B><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; font-weight:bold; letter-spacing:-0.25pt;" >Step 1</FONT></B></P></TD>
  <TD width="33.86%">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >Select  Macro from the Tools Menu.  (1)<BR></FONT></P></TD>
  <TD width="37.25%" bgcolor="#e5e5e5">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >The Macro dialog box is displayed. </FONT><FONT size=1  style="font-family:'Courier'; font-size:9pt; letter-spacing:-0.25pt;" >(2)</FONT><FONT size=1  style="font-family:'Wingdings'; font-size:9pt; letter-spacing:-0.25pt;" >  </FONT></P></TD></TR>
  <TR valign=top>
  <TD width="18.06%" bgcolor="#e5e5e5">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >Macro dialog box </FONT><FONT size=1  style="font-family:'Courier'; font-size:9pt; letter-spacing:-0.25pt;" >(2)</FONT></P></TD>
  <TD width="10.84%">
  <P align="left"  style="margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><B><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; font-weight:bold; letter-spacing:-0.25pt;" >Step 2</FONT></B></P></TD>
  <TD width="33.86%">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >Enter the name of the macro you are going to create. </FONT><FONT size=1  style="font-family:'Courier'; font-size:9pt; letter-spacing:-0.25pt;" >(3)<BR></FONT></P></TD>
  <TD width="37.25%" bgcolor="#e5e5e5">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" >&nbsp;</P></TD></TR>
  <TR valign=top>
  <TD width="18.06%" bgcolor="#e5e5e5">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >Macro dialog box </FONT><FONT size=1  style="font-family:'Courier'; font-size:9pt; letter-spacing:-0.25pt;" >(2)<BR></FONT></P></TD>
  <TD width="10.84%">
  <P align="left"  style="margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><B><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; font-weight:bold; letter-spacing:-0.25pt;" >Step 3</FONT></B></P></TD>
  <TD width="33.86%">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >Click the Create button. </FONT><FONT size=1  style="font-family:'Courier'; font-size:9pt; letter-spacing:-0.25pt;" >(4)</FONT></P></TD>
  <TD width="37.25%" bgcolor="#e5e5e5">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >The Macro creation window is displayed.</FONT><FONT size=1  style="font-family:'Courier'; font-size:9pt; letter-spacing:-0.25pt;" >(5)</FONT></P></TD></TR>
 </TABLE>
 <TABLE width="597" cellspacing='0' cellpadding="1">
  <TR valign=top>
  <TD width="16.06%" bgcolor="#e5e5e5">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >Macro creation window </FONT><FONT size=1  style="font-family:'Courier'; font-size:9pt; letter-spacing:-0.25pt;" >(5)</FONT></P></TD>
  <TD width="9.64%">
  <P align="left"  style="margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><B><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; font-weight:bold; letter-spacing:-0.25pt;" >Step 4</FONT></B></P></TD>
  <TD width="74.30%">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >Insert the following macro: (Note: you can open the </FONT><I><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; font-style:italic; letter-spacing:-0.25pt;" >word.txt </FONT></I><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" > file located in the \DECTALK\ directory, copy it, and paste it into the Word macro.)</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >Sub MAIN</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >If AppIsRunning(&quot;TTSsrv&quot;) = 0 Then</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >      Shell &quot;TTSSRV.EXE&quot;, 0</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >      rightNow = Now()</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >      diffTime = 0</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >      Print &quot;Starting DECtalk Server&quot;</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >      WaitCursor 1</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >      While diffTime &lt; 0.00003</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >          diffTime = Now() - rightNow</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >      Wend</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >      WaitCursor 0</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >      Print &quot; &quot;</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >   If AppIsRunning(&quot;TTSsrv&quot;) = 0 Then</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >   MsgBox(&quot;Cannot find TTSSRV.EXE in the path&quot;, &quot;Speak&quot;, 0)</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >   Goto FINIS</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >   End If</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >End If</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >   channel = DDEInitiate(&quot;TTSserver&quot;, &quot;Speak&quot;)</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >   If channel = 0 Then</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >   MsgBox(&quot;Unable to connect to TTSSRV.EXE&quot;, &quot;Speak&quot;, 0)</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >   Goto FINIS</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >   Else</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >      DDEPoke channel, &quot;Speak&quot;, Selection$()</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >      DDETerminate channel</FONT></P>
  <P align="left"  style="margin-left:5.75pt;margin-right:6.50pt;margin-top:0.00pt;margin-bottom:2.40pt;text-align:left;" ><FONT size=1  style="font-family:'Courier New'; font-size:9pt; " >FINIS:<BR>End Sub<BR></FONT></P></TD></TR>
 </TABLE>
 <TABLE width="531" cellspacing='0' cellpadding="1">
  <TR valign=top>
  <TD width="18.06%" bgcolor="#e5e5e5">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >File pull-down menu. </FONT></P></TD>
  <TD width="10.84%">
  <P align="left"  style="margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><B><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; font-weight:bold; letter-spacing:-0.25pt;" >Step 5</FONT></B></P></TD>
  <TD width="34.70%">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >On the File menu, click Close  (6). Click Yes  (7) when you are asked if you want to keep changes to the macro.</FONT></P></TD>
  <TD width="36.41%" bgcolor="#e5e5e5">
  <P align="left"  style="margin-left:5.05pt;margin-right:5.05pt;margin-top:2.00pt;margin-bottom:2.50pt;text-align:left;line-height:10.50pt;" ><FONT size=1  style="font-family:'Helvetica'; font-size:9pt; letter-spacing:-0.25pt;" >The macro is created.</FONT></P></TD></TR>
 </TABLE>
 <P align="left"  style="margin-top:0.00pt;margin-bottom:8.00pt;text-align:left;" >&nbsp;</P>
 <P align="left"  style="margin-top:0.00pt;margin-bottom:8.00pt;text-align:left;border-top:0.75pt solid black;" ><A href="#" onClick="var e; if (parseInt(navigator.appVersion)>=4){e=event;}  if (parseInt(navigator.appVersion) >=2 && typeof(PopupMenu_Invoke) == 'function') PopupMenu_Invoke(e,'','Associating a macro with a toolbar button','idh_nt_apps_to_associate_a_macro_with_a_tool_bar_button.htm','Speaking text with the DECtalk TTS Server','idh_nt_apps_to_speak_text_with_the_dectalk_tts_server.htm');return false;"><IMG SRC="btn_mini.gif" border=0 height=14 width=14 alt="btn_mini.gif"></A><FONT size=2  style="font-family:'Helvetica'; font-size:10pt; " >  </FONT><A href="#" onClick="var e; if (parseInt(navigator.appVersion)>=4){e=event;}  if (parseInt(navigator.appVersion) >=2 && typeof(PopupMenu_Invoke) == 'function') PopupMenu_Invoke(e,'','Associating a macro with a toolbar button','idh_nt_apps_to_associate_a_macro_with_a_tool_bar_button.htm','Speaking text with the DECtalk TTS Server','idh_nt_apps_to_speak_text_with_the_dectalk_tts_server.htm');return false;"><FONT size=2  style="font-family:'Helvetica'; font-size:10pt; color:black; text-decoration:none;" >Related topics</FONT></A><FONT size=2  style="font-family:'Helvetica'; font-size:10pt; " > </FONT></P>
 <script LANGUAGE="JavaScript" title="%s">
<!--
if (parseInt(navigator.appVersion) >= 3 && typeof (WritePopupMenuLayer) == "function")
	WritePopupMenuLayer();
//-->
 </script>
</BODY>
</HTML>